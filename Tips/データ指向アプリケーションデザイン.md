- [知見](#知見)
  - [アプリケーション構成要素](#アプリケーション構成要素)
  - [フォールト→要件を満たしていない動作全般, 障害→システムがサービスの提供を止めてしまった状態](#フォールト要件を満たしていない動作全般-障害システムがサービスの提供を止めてしまった状態)
  - [フォールトを回避するのではなく、耐性を持つようにすると考えるのが良い場合もある。](#フォールトを回避するのではなく耐性を持つようにすると考えるのが良い場合もある)
  - [開発コストや運用コストを下げることは、システムの信頼性を犠牲にしているということを認識するべきである。](#開発コストや運用コストを下げることはシステムの信頼性を犠牲にしているということを認識するべきである)
  - [負荷を語る](#負荷を語る)
  - [Twitterの例だと、1,2のアプローチでそれぞれ利点と欠点があり、一長一短であったが、一般のアカウントに対しては、2のアルゴリズムを適用する。](#twitterの例だと12のアプローチでそれぞれ利点と欠点があり一長一短であったが一般のアカウントに対しては2のアルゴリズムを適用する)
  - [10章 バッチ処理](#10章-バッチ処理)
    - [オンラインシステム構成要素の定義](#オンラインシステム構成要素の定義)
    - [アクセスログの分析](#アクセスログの分析)
  - [本書で出てきたツール](#本書で出てきたツール)
    - [Redis(レディス): データストア。メッセージキューとしても使われる。](#redisレディス-データストアメッセージキューとしても使われる)
    - [Apache Kafka: メッセージキュー。だが、データベースのような耐久性が保証されている。](#apache-kafka-メッセージキューだがデータベースのような耐久性が保証されている)
    - [Apache Hadoop: 分散処理を実現するためのオープンソースのソフトウェアフレームワーク](#apache-hadoop-分散処理を実現するためのオープンソースのソフトウェアフレームワーク)


# 知見
## アプリケーション構成要素
- データベース: データを保存しておいて、あとで参照できるようにする。
- キャッシュ: 処理量の多い操作の結果を覚えておき、読み取り速度を高める。
- 検索インデックス: データの検索や、データのフィルタリングに利用する。
- ストリーム処理: 他のプロセスで処理するためにメッセージを送る。
- バッチ処理: 一定量のデータを定期的に処理する。

## フォールト→要件を満たしていない動作全般, 障害→システムがサービスの提供を止めてしまった状態
## フォールトを回避するのではなく、耐性を持つようにすると考えるのが良い場合もある。
## 開発コストや運用コストを下げることは、システムの信頼性を犠牲にしているということを認識するべきである。
## 負荷を語る
`負荷パラメータ`と呼ばれる数値を使って表現すること。<br>
何が適した負荷パラメータとなるのかは、システムのアーキテクチャに依存する。
例: Webサーバ→1秒あたりのリクエスト数、チャットルーム→同時アクティブユーザー数、キャッシュ→ヒット率
## Twitterの例だと、1,2のアプローチでそれぞれ利点と欠点があり、一長一短であったが、一般のアカウントに対しては、2のアルゴリズムを適用する。<br>
フォロワーの多い有名人のアカウントでは1のアルゴリズムを適用するという設計に切り替えた。

## 10章 バッチ処理
### オンラインシステム構成要素の定義
- データベース
- キャッシュ
- 検索インデックス
- Webサーバー
etcだが、上記が出てきたら「オンライン」だと考える。<br>
1つの構成、それがシステムを構築する時の、唯一の方法だと考えるのではなく、他のアプローチについてもメリットがあることを覚えておかなければならない。


### アクセスログの分析
最低限、`awk`, `sed`, `grep`, `sort`, `uniq`, `xargs`, `find`, `head`, `tail`のコマンドを組み合わせると、データ分析がラクにできる。
```bash
cat /var/log/nginx/access.log |
  awk '{print $7}' |  # 各行から7番目のフィールドの値を抜き出す
  sort |              # アルファベット順にsort
  uniq -c |           # -c 各行が登場した回数を表示する
  sort -r -n |        # -n 各行の先頭にある数値でsortして、結果を降順-rで出力
  head -n 5           # 先頭の5行だけ出力
```

## 本書で出てきたツール
### Redis(レディス): データストア。メッセージキューとしても使われる。
### Apache Kafka: メッセージキュー。だが、データベースのような耐久性が保証されている。
### Apache Hadoop: 分散処理を実現するためのオープンソースのソフトウェアフレームワーク
