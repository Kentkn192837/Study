# データベースの種類
- 階層型データベース
- 網型データベース(ネットワーク型データベース)
- 関係データベース(リレーショナルデータベース)

## 階層型データベース
木構造でデータの構造を表現するデータベース

## 網型データベース
親レコードが複数の子レコードをもつことができ、子レコードもまた親レコードを複数持つことができるような構造を表現するデータベース

## 階層型データベース
データを平坦な2次元の表で表現したデータベース

# 3層スキーマ
データベースのモデルを考える際に、データを扱う立場を外部スキーマ、概念スキーマ、内部スキーマのそれぞれの観点に対応したデータ定義を行うモデル。

## 外部スキーマ


## 概念スキーマ

## 内部スキーマ


# データベースの正規化
## 第1正規化
関係データベース中の繰り返し部分を排除する操作を第1正規化という。第1正規化では修正時異常、挿入時異常、削除時異常が懸念される場面が多く発生し得るので、これを防止するために第2正規化、第3正規化というステップがある。

## 第2正規化
第2正規化は第1正規化された表に対して行われる操作で、候補キーの一部に部分関数従属する非キー属性を別の表に分解する。

## 第3正規化
第3正規化では候補キーに推移的関数従属している非キー属性を別の表に分解することで、非キー属性間の関数従属をなくし、どの非キー属性も候補キーに直接的に関数従属している状態にする。

# データベースの演算
## 選択と射影
選択･･･行を取り出す
射影･･･列を取り出す

# 結合
```
SELECT 社員コード, 社員名, 部門表.部門コード, 部門名
    FROM 社員表, 部門表
    WHERE 社員表.部門コード = 部門表.部門コード
```

# 埋め込みSQL
## 埋め込みSQLの基本
この方法は条件に合ったデータを1行のみ取得できる。
```
EXEC SQL SELECT 列名リスト INTO :ホスト変数名リスト
    FROM 表名
    (WHERE 条件式)
```

- ホスト変数
SELECT文の結果を受け取る変数。INTO句に指定して利用する。

利用例
```mysql:example.sql
EXEC SQL SELECT 社員名, 年齢 INTO :name, :age FROM 社員表
    WHERE 社員コード = '100';
```
社員表の中から社員コードが`100`となるような社員名と年齢をそれぞれ`:name`と`:age`で受け取る。

## 複数行のデータの取得
FETCH文を用いてカーソル処理と呼ばれる操作を行うことで複数行の結果を取得することができる。

```c:example.c
EXEC SQL DECLARE syain_cursor CURSOR FOR
    SELECT 社員名 FROM 社員表
    WHERE 住所 LIKE '東京%';

EXEC SQL OPEN syain_cursor;
while (1) {
    EXEC SQL FETCH syain_cursor INTO :name;
    if (SQLCODE != 0) break;
    printf("氏名は%s\n", name);
}
EXEC SQL CLOSE syain_cursor;
```

- 処理途中でエラーが発生し、それまでの更新処理を取り消して元に戻す操作

`EXEC SQL ROLLBACK`

- トランザクションが正常終了したとき、更新処理を確定させる操作

`EXEC SQL COMMIT`


# データベース管理システム
- トランザクション管理
- 同時実行制御
- 障害回復管理
- 問い合わせ処理の効率化
- データベースのチューニング

## トランザクション管理
### トランザクション処理が備える必要がある4つの特性
原子性, 一貫性, 隔離性, 耐久性
