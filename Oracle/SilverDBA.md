- [知見](#知見)
  - [DESCはDESCRIBEコマンドの省略形](#descはdescribeコマンドの省略形)
  - [`''`で囲った文字列の内部で、単なる文字列としてシングルクォートを使いたい場合の対処](#で囲った文字列の内部で単なる文字列としてシングルクォートを使いたい場合の対処)
  - [列の別名に`$`, `_`, `#`以外の記号を含むとき（` `, `-`など）は、文字列を`""`で囲う](#列の別名に-_-以外の記号を含むとき---などは文字列をで囲う)
- [要注意！落とし穴リスト](#要注意落とし穴リスト)
  - [5章 権限の管理](#5章-権限の管理)
  - [「セグメント作成の遅延」と「クオータ割り当て」について確認する。](#セグメント作成の遅延とクオータ割り当てについて確認する)
  - [システム権限の付与→WITH ADMIN OPTION, オブジェクト権限の付与→WITH GRANT OPTION](#システム権限の付与with-admin-option-オブジェクト権限の付与with-grant-option)
  - [LIKEで指定する検索条件: `_`: 任意の一文字, `%`: 任意の文字列](#likeで指定する検索条件-_-任意の一文字--任意の文字列)
  - [ORDER BYで昇順で並べ替えた時、NULLは末尾、降順の時はNULLは先頭になる。](#order-byで昇順で並べ替えた時nullは末尾降順の時はnullは先頭になる)
  - [置換変数`&`と`&&`の挙動の違い](#置換変数との挙動の違い)
  - [日時+日時の演算はできない](#日時日時の演算はできない)
  - [集計ファンクションをネストする時は、GROUP BY句が必要](#集計ファンクションをネストする時はgroup-by句が必要)

# 知見
## DESCはDESCRIBEコマンドの省略形
`DESCRIBE`,`DESC`は、指定したテーブルの「カラム名」「NULLがOKか否か」「型」を取得できます。
```sql
DESCRIBE <テーブル名>;
DESCRIBE INVENTORY;
DESC INVENTORY;
```

## `''`で囲った文字列の内部で、単なる文字列としてシングルクォートを使いたい場合の対処
`'`を`'あいう'えお'`とした時に、`あいう'えお`という文字列として扱いたいなどといった場合は、
- 文字列として扱いたいシングルクォートを2つ繋げて書く→`'あいう''えお'`
- `q'<任意の一文字>.*<任意の一文字>'`というように、`q'<任意の一文字>`と`<任意の一文字>'`で文字列を囲う。→`q'#あいう'えお#'`, `q'|あいう'えお|'`<br>
<任意の一文字>は、同じ文字でなくても良いので、`q'(あいう'えお)'`, `q'<あいう'えお>'`でも良い。

## 列の別名に`$`, `_`, `#`以外の記号を含むとき（` `, `-`など）は、文字列を`""`で囲う

# 要注意！落とし穴リスト
## 5章 権限の管理
## 「セグメント作成の遅延」と「クオータ割り当て」について確認する。
- クオータ: あるユーザーに対して割り当てられた表領域において、そのユーザーが利用可能な表領域の最大サイズのこと。<br>一時表領域、UNDO表領域は、クオータを割り当てなくても利用可能。<br>
`UNLIMITED TABLESPACE`システム権限が付与されている場合も、クオータ割り当て不要。

## システム権限の付与→WITH ADMIN OPTION, オブジェクト権限の付与→WITH GRANT OPTION
`SYS`と`SYSTEM`は、`GRANT ANY PRIVILEGE`権限がデフォルトで付与されている。<br>
あるスキーマにシステム権限やオブジェクト権限が付いているかどうか確認するには、
`DBA_TAB_PRIVS`や`USER_TAB_PRIVS`ビューを参照すれば良い。

## LIKEで指定する検索条件: `_`: 任意の一文字, `%`: 任意の文字列
## ORDER BYで昇順で並べ替えた時、NULLは末尾、降順の時はNULLは先頭になる。
## 置換変数`&`と`&&`の挙動の違い
- `&empno`が呼ばれる度に値の入力を求められる。: `&empno`
- `&&empno`が呼ばれるのは一度だけで、最初に入力した値が使いまわされる。: `&&empno`

## 日時+日時の演算はできない
例えば、以下のような処理はエラーとなる。
```sql
SELECT TO_DATE('2021/01/02 00:00:00') + TO_DATE('2021/01/01 00:00:00') FROM DUAL;
```

```
行1でエラーが発生しました。:
ORA-00975: 日付と日付の加算はできません。
```

## 集計ファンクションをネストする時は、GROUP BY句が必要
下のsqlは一見よさそうだが、実はエラーになる。
```sql
SELECT MAX(AVG(sal)) FROM emp;
```

集計ファンクションをネストして利用する時は、1段階目の集計処理を複数行にするために、<br>
`GROUP BY`でグループ化しておいて、2段階目の集計処理にグループ化したテーブルの処理が走る。
```sql
SELECT MAX(AVG(sal)) FROM emp GROUP BY deptno;
```
